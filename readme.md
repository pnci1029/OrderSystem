# 기본 정보
### BE 
````
    JDK 17
    Spring 3.3.4
    Libraries : lombok, websocket 
````

### FE
````
    Node 18.10.0
    Libraries : Typescript, React-dom
````

## 기능 명세

#### createOrder
| 구분  | 내용                                                            |
|-----|---------------------------------------------------------------|
| 요청값 | 메뉴 이름, 수량                                                     |
| 설명  | 요청받은 주문을 생성하여 Map에 저장한다. 초기 상태는 "접수 됨"으로 고정된다.                |
| 성공  | 저장된 주문정보를 응답하고, 연결된 session에 대해서 소켓 통신으로 전체 주문 내용을 브로드캐스트 한다. |

<br />
<br />

#### updateOrder
|구분| 내용                                                                                                    |
|---|-------------------------------------------------------------------------------------------------------|
| 요청값 | 주문 식별 ID(orderId)                                                                                     |
|설명| 요청받은 주문에 대한 상태를 업데이트한다.                                                                               |
|성공| 접수됨 -> 처리 중, 처리 중 -> 처리완료로 상태를 업데이트하고, 업데이트 된 정보를 응답한다. 연결된 session에 대해서 소켓 통신으로 전체 주문 내용을 브로드캐스트 한다. |

## Websocket 통신 프로세스
````
  전체 프로세스
    1. 주문 현황 페이지 조회 시 클라이언트는 백엔드와 웹소켓 통신을 연결한다.
    2. 주문 생성 / 주문 상태 변경 API 요청 시 생성 또는 변경 동작을 수행하고, 
    연결된 웹소켓 세션들에 대해 전체 주문 데이터를 조회하여 반환한다.
````

## Websocket 통신 시 다수의 주문이 들어오는 경우에 대한 고민
````
    멀티 스레드 환경에서 다량의 데이터가 동시다발적으로 들어오는 경우,
    처리 순서가 엉켜서 클라이언트와 서버간의 처리 순사가 보장되지 않을 수 있을거라는 생각이 들었따.
    
    주문 데이터의 일관성을 지키기 위해 메세지 큐를 도입해보았다.
    
    isProcess라는 전역 변수를 두어,
    큐가 메세징 처리중일때 다른 스레드의 요청을 막아서 일관된 데이터를 유지하도록 처리했다.
    
````
